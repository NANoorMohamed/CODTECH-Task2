import nmap
import re

banner = "   ------ VULNERABILITY SCANNER ------    "
print(banner)
scanner = nmap.PortScanner()

def is_valid_ip(ip):
    pattern = r"^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$"
    if re.match(pattern, ip):
        return all(0 <= int(num) <= 255 for num in ip.split('.'))
    return False


ip_address = input("Please enter the IP address you want to scan: ")
if not is_valid_ip(ip_address):
    print("Invalid IP address format.")
else:
    print("The IP you entered is:", ip_address)

    # UDP Scan
    scanner.scan(ip_address, "1-1024", "-v -sU")
    print(scanner.scaninfo())
    print("IP Status:", scanner[ip_address].state())

    if "udp" in scanner[ip_address].all_protocols():
        print("Open Ports (UDP):", scanner[ip_address]["udp"].keys())
    else:
        print("No open UDP ports found.")

    # TCP Scan
    scanner.scan(ip_address, "1-1024", "-v -sS -sV -sC -A -O")
    print(scanner.scaninfo())
    print("IP Status:", scanner[ip_address].state())

    if "tcp" in scanner[ip_address].all_protocols():
        print("Open Ports (TCP):", scanner[ip_address]["tcp"].keys())
    else:
        print("No open TCP ports found.")
